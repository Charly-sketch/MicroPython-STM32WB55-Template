# BLE Central Device Scanner (MicroPython)

This project implements a Bluetooth Low Energy (BLE) Central role using MicroPython. It scans nearby BLE peripherals, attempts to connect to each one, and tries to read the device name using both advertisement data and the GATT Generic Access service.

## üì¶ Features

- Scans for nearby BLE devices for 10 seconds.
- Filters out duplicate devices during scanning.
- Connects to each discovered device one-by-one.
- Attempts to read the device name:
  - First via GATT (characteristic `0x2A00` in service `0x1800`)
  - Falls back to the advertised name (ADV) if GATT is unavailable.
- Skips unresponsive devices after a 5-second timeout.
- Logs connection and disconnection events for each device.

## üîß Requirements

- MicroPython board with BLE support (e.g., ESP32, STM32WB55)
- MicroPython firmware with `bluetooth` and `ubluetooth` modules enabled
- `ble_advertising.py` helper module (for parsing advertisement payloads)

## üöÄ How to Use

1. Flash the code to your MicroPython-compatible device.
2. Open a serial connection (e.g., via `minicom`, `screen`, or Thonny).
3. Reset the board. It will:
   - Scan for devices
   - Attempt connections
   - Print detected names or fallbacks

You should see output like:

```
Scan complete. Found devices:                                                                                                                        
- 0 b"\xfa\r\xac\xbf'\xd1" ?                                                                                                                         
- 0 b'Re\xf3\x00\xe2_' ?                                                                                                                             
- 0 b'\xa4\xc18BgO' ?                                                                                                                                
- 0 b'\xf9\x8d\x1fq.L' ?
- 0 b'\xa4\xc18\x87\xd0\xb0' ?
- 0 b'\xa4\xc18;\x85c' ?
- 0 b'\xa4\xc18\xc2M\xe8' ?
- 0 b'\xa4\xc184\xdf\xb0' ?
- 0 b'\xa4\xc18at#' ?
- 0 b'\xa4\xc18\xe2\x13\x06' ?
- 0 b'\xa4\xc188f\xbf' ?
- 0 b'fN\xd79\xa7\r' ?
- 1 b'R\xed(\xbbp\xff' ?
- 0 b'\xa4\xc18\x12\xcb\x8f' ?
- 0 b'\xa4\xc18\xfb\n\x95' ?
- 0 b'\xa4\xc18\xab\xd8|' ?
- 0 b'\xa4\xc18}\r\xce' ?
- 0 b'\xa4\xc18|/O' ?
- 0 b'\xa4\xc18U\xb9Y' ?
- 0 b'\xa4\xc18\xe1A\xd4' ?
- 0 b'\xa4\xc18x:d' ?
- 0 b'\xa4\xc18w\x1a\xb3' ?
- 0 b'\xa4\xc18?\x19\xd6' ?
- 0 b'\xa4\xc18\x11\x18&' ?
- 1 b'f\x94\x8b\xea%g' ?
- 1 b'\xc4\xed\xb2\xa1\xc1\xc1' ?
Connecting to 0 b"\xfa\r\xac\xbf'\xd1" (?)...
Disconnected from b"\xfa\r\xac\xbf'\xd1"
Connecting to 0 b'Re\xf3\x00\xe2_' (?)...
Disconnected from b'Re\xf3\x00\xe2_'
Connecting to 0 b'\xa4\xc18BgO' (?)...
Disconnected from b'\xa4\xc18BgO'
Connecting to 0 b'\xf9\x8d\x1fq.L' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18\x87\xd0\xb0' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18;\x85c' (?)...
Disconnected from b'\xa4\xc18;\x85c'
Connecting to 0 b'\xa4\xc18\xc2M\xe8' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc184\xdf\xb0' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18at#' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18\xe2\x13\x06' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc188f\xbf' (?)...
Connection timeout, skipping...
Connecting to 0 b'fN\xd79\xa7\r' (?)...
Disconnected from b'fN\xd79\xa7\r'
Connecting to 1 b'R\xed(\xbbp\xff' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18\x12\xcb\x8f' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18\xfb\n\x95' (?)...
Disconnected from b'\xa4\xc18\xfb\n\x95'
Connecting to 0 b'\xa4\xc18\xab\xd8|' (?)...
Disconnected from b'\xa4\xc18\xab\xd8|'
Connecting to 0 b'\xa4\xc18}\r\xce' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18|/O' (?)...
Disconnected from b'\xa4\xc18|/O'
Connecting to 0 b'\xa4\xc18U\xb9Y' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18\xe1A\xd4' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18x:d' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18w\x1a\xb3' (?)...
Connection timeout, skipping...
Connecting to 0 b'\xa4\xc18?\x19\xd6' (?)...
Disconnected from b'\xa4\xc18?\x19\xd6'
Connecting to 0 b'\xa4\xc18\x11\x18&' (?)...
Connection timeout, skipping...
Connecting to 1 b'f\x94\x8b\xea%g' (?)...
Connection timeout, skipping...
Connecting to 1 b'\xc4\xed\xb2\xa1\xc1\xc1' (?)...
Connection timeout, skipping...
All devices tested.
```

## ‚ö†Ô∏è Notes

- Many commercial BLE devices do **not expose** the GATT Device Name characteristic (`0x2A00`). This is expected behavior.
- Some devices do **not include** a name in their advertisement data (`adv_data`).
- For testing, use another ESP32 or a custom BLE device (e.g., via nRF Connect) that advertises a name.

## üß™ Recommended Test Peripheral

You can test this code using a simple BLE peripheral that advertises a name. For example, on another ESP32:

```python
import bluetooth
from ble_advertising import advertising_payload

ble = bluetooth.BLE()
ble.active(True)
payload = advertising_payload(name="ESP32_Test")
ble.gap_advertise(100_000, adv_data=payload)
```
